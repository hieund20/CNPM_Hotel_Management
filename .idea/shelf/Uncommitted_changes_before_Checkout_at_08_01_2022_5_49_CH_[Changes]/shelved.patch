Index: src/static/css/history.css
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>.border-history{\r\n    border: 1px solid #aba5a5;\r\n    margin-top: 48px;\r\n    margin-bottom: 48px;\r\n}\r\n\r\n.title-history{\r\n    color: #a7783e;\r\n    margin: 15px 0 35px 15px;\r\n}\r\n\r\n/* info */\r\n\r\n.border-if{\r\n    border: 2px dotted  black;\r\n    margin-left: 25px;\r\n    margin-bottom: 35px;\r\n    padding-bottom: 25px;\r\n}\r\n\r\n.border-if > h4{\r\n    margin: 15px 0 15px 5px;\r\n}\r\n.border-if span{\r\n    font-style: oblique;\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/static/css/history.css b/src/static/css/history.css
--- a/src/static/css/history.css	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/static/css/history.css	(date 1641635996374)
@@ -9,6 +9,11 @@
     margin: 15px 0 35px 15px;
 }
 
+.history-payments input{
+    margin: 0 5% 0 5%;
+    width: 89%;
+}
+
 /* info */
 
 .border-if{
Index: src/templates/history-payments.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends 'layout/base.html' %}\r\n\r\n{% block title %}Lịch sử thanh toán{% endblock %}\r\n\r\n{% block content %}\r\n    <div class=\"container border-history\">\r\n        <h3 class=\"title-history\">LỊCH SỬ THANH TOÁN</h3>\r\n        <div class=\"row\">\r\n            <div class=\"col-lg-6\">\r\n                <input type=\"text\" class=\"search-cart\" onkeyup=\"\" placeholder=\"Nhập tên phòng...\"\r\n                       title=\"Tìm kiếm theo tên\">\r\n            </div>\r\n            <div class=\"col-lg-5 border-if\">\r\n                <h4 >Thông tin người thanh toán</h4>\r\n                <div><span>Tên: </span>&emsp;&emsp;&emsp;&emsp;&ensp;&ensp;&ensp;{{info_payer.visit_name}}</div>\r\n                <div><span>Số điện thoại: </span>&emsp;{{info_payer.phone_number}}</div>\r\n                <div><span>Email: </span>&emsp;&emsp;&emsp;&emsp;&nbsp;&nbsp;{{info_payer.email}}</div>\r\n                <div><span>Quốc tịch:</span>&nbsp;&nbsp;&nbsp;&emsp;&emsp;{{info_payer.nation}}</div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/templates/history-payments.html b/src/templates/history-payments.html
--- a/src/templates/history-payments.html	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/templates/history-payments.html	(date 1641636048186)
@@ -5,10 +5,37 @@
 {% block content %}
     <div class="container border-history">
         <h3 class="title-history">LỊCH SỬ THANH TOÁN</h3>
-        <div class="row">
+        <div class="row history-payments">
             <div class="col-lg-6">
-                <input type="text" class="search-cart" onkeyup="" placeholder="Nhập tên phòng..."
-                       title="Tìm kiếm theo tên">
+                <div class="row list-cart" id="list-room">
+                    <input type="text" class="search-cart" onkeyup="searchCart(this)"  placeholder="Tìm kiếm theo tên..."
+                           title="Tìm kiếm theo tên">
+                    {% for i in list_booking_room %}
+                    <div class="row col-lg-12 lc  room-cart">
+
+                        <div class="col-lg-3">
+                            <img src="{{i.image}}">
+                        </div>
+
+                        <div class="col-lg-6">
+                            <div class="name-room">
+                                <span id="name-cart">{{i.room_name}}</span>
+                                <span class="person-amount">{{i.person_amount}} người</span>
+                            </div>
+                            <div class="date-order">
+                                <div>Ngày nhận: <span class="color-gray">{{i.pay_day}}</span></div>
+                                <span>Ngày trả: <span class="color-gray">{{i.receive_day}}</span></span>
+                            </div>
+                        </div>
+
+                        <div class="col-lg-2 color-money">
+                            {{i.price}}$
+                        </div>
+
+
+                    </div>
+                    {% endfor %}
+                </div>
             </div>
             <div class="col-lg-5 border-if">
                 <h4 >Thông tin người thanh toán</h4>
Index: src/utils.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from sqlalchemy import func, extract\r\nimport hashlib\r\nfrom datetime import datetime\r\n\r\nimport mysql.connector\r\nfrom sqlalchemy import desc, asc\r\nfrom sqlalchemy import func, extract\r\n\r\nfrom src import app, db\r\nfrom src.models import Room, TypeRoom, ReceiptDetail, User, Receipt, RentalVoucher, \\\r\n    RentalVoucherDetail, BookingRoom\r\n\r\nmydb = mysql.connector.connect(\r\n    host=\"localhost\",\r\n    user=\"root\",\r\n    passwd=\"Duchieu200301\",\r\n    database=\"hotel_management_db\"\r\n)\r\n\r\n\r\ndef get_all_type_rooms():\r\n    return TypeRoom.query.all()\r\n\r\n\r\n# Get used quantity type room in current month\r\ndef get_used_quantity_type_room_in_month():\r\n    query = db.session.query(TypeRoom.id, TypeRoom.type_room_name, func.count(TypeRoom.id), ).filter(\r\n        Room.type_room_id == TypeRoom.id).filter(Room.id == ReceiptDetail.room_id).filter(\r\n        extract('month', ReceiptDetail.receive_day) == datetime.now().month).group_by(TypeRoom.id,\r\n                                                                                      TypeRoom.type_room_name)\r\n    return query.all()\r\n\r\n\r\ndef add_user(username, password, email):\r\n    password = str(hashlib.md5(password.strip().encode('utf-8')).hexdigest())\r\n    user = User(username=username.strip(), password=password,\r\n                email=email)\r\n\r\n    db.session.add(user)\r\n    db.session.commit()\r\n\r\n\r\ndef check_login(username, password):\r\n    if username and password:\r\n        password = str(hashlib.md5(password.strip().encode(\r\n            'utf-8')).hexdigest())  # hash bằng md5 khi create password thì cũng hash bằng md5 khi login\r\n\r\n        return User.query.filter(User.username.__eq__(username.strip()),\r\n                                 User.password.__eq__(password)).first()\r\n\r\n\r\ndef get_user_by_id(user_id):\r\n    return User.query.get(user_id)\r\n\r\n\r\ndef count_cart(cart):\r\n    quantity, amount = 0, 0\r\n    if cart:\r\n        for i in cart.values():\r\n            quantity += i['quantity']\r\n            amount += i['quantity'] * i['price']\r\n    return {\r\n        'totalQuantity': quantity,\r\n        'totalAmount': amount\r\n    }\r\n\r\n\r\ndef is_name_in_receipt(name):\r\n    return Receipt.query.filter(Receipt.visitor_name.__eq__(name)).first()\r\n\r\n\r\ndef add_receipt(name, address, price):\r\n    new = Receipt(visitor_name=name, address=address, price=price)\r\n    db.session.add(new)\r\n    db.session.commit()\r\n\r\n\r\ndef get_user_by_name(name):\r\n    return User.query.filter(User.username.__eq__(name)).first()\r\n\r\n\r\ndef get_all_rooms(page):\r\n    page_size = app.config['PAGE_SIZE']\r\n    start = (page - 1) * page_size\r\n    end = start + page_size\r\n\r\n    query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id,\r\n                             Room.rental_voucher, Room.image, Room.descriptions, TypeRoom.type_room_name).filter(\r\n        Room.type_room_id == TypeRoom.id)\r\n\r\n    return query.slice(start, end).all()\r\n\r\n\r\ndef get_room_by_id(room_id):\r\n    return Room.query.get(room_id)\r\n\r\n\r\ndef get_type_room_by_room_id(room_id):\r\n    query = db.session.query(TypeRoom.type_room_name).filter(Room.type_room_id == TypeRoom.id).filter(\r\n        Room.id == room_id)\r\n    return query.all()\r\n\r\n\r\ndef cart_stats(cart):\r\n    total_amount, total_quantity = 0, 0\r\n    if cart:\r\n        for p in cart.values():\r\n            total_quantity += p[\"quantity\"]\r\n            total_amount = p[\"price\"]\r\n\r\n    return total_quantity, total_amount\r\n\r\n\r\ndef add_receipt_detail(room_id, room_name, price, quantity, receive_day, pay_day, person_amount):\r\n    receipt_detail = ReceiptDetail(room_id=room_id,\r\n                                   room_name=room_name,\r\n                                   price=price,\r\n                                   quantity=quantity,\r\n                                   receive_day=receive_day,\r\n                                   pay_day=pay_day,\r\n                                   person_amount=person_amount)\r\n    db.session.add(receipt_detail)\r\n    db.session.commit()\r\n\r\n\r\ndef get_user_by_name(name):\r\n    return User.query.filter(User.username.__eq__(name)).first()\r\n\r\n\r\ndef total_room_by_receiptId(receipt_id):\r\n    # receipt=ReceiptDetail.query.filter(ReceiptDetail.user_id.__eq__(user_id))\r\n    # receipt=ReceiptDetail.query.all()\r\n    # return  db.session.query(func.count(ReceiptDetail.id))\r\n\r\n    return ReceiptDetail.query.all()\r\n\r\n\r\ndef get_list_receipt_detail():\r\n    # list=ReceiptDetail.query.filter(ReceiptDetail.receipt_id.__eq__(receipt_id))\r\n    query = db.session.query(Room.image, ReceiptDetail.room_name, ReceiptDetail.id, ReceiptDetail.pay_day,\r\n                             ReceiptDetail.price, ReceiptDetail.quantity, ReceiptDetail.receive_day,\r\n                             ReceiptDetail.person_amount, Room.id).filter(Room.id == ReceiptDetail.room_id)\r\n    print('query default', query)\r\n    return query.all()\r\n\r\n\r\ndef total_money(user_id):\r\n    # rd = ReceiptDetail.query.filter(ReceiptDetail.user_id.__eq__(user_id))\r\n    rd = ReceiptDetail.query.all()\r\n    total = 0\r\n    for r in rd:\r\n        total += r.price\r\n    return total\r\n\r\n\r\ndef delete_Receipt_detail(id):\r\n    mycursor = mydb.cursor()\r\n    sql = \"DELETE FROM receipt_detail WHERE id = \" + id\r\n    mycursor.execute(sql)\r\n    mydb.commit()\r\n\r\n\r\ndef count_rooms(type_room_id, quantity_bed, price_order_by):\r\n    query = \"\"\r\n    if (type_room_id == '' and quantity_bed == '' and price_order_by == '') or \\\r\n            (type_room_id is None and quantity_bed is None and price_order_by is None):\r\n        query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                 Room.descriptions, TypeRoom.type_room_name).filter(\r\n            Room.type_room_id == TypeRoom.id).order_by(asc(Room.price))\r\n    if price_order_by == 'asc':\r\n        if quantity_bed == '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).order_by(asc(Room.price))\r\n        if quantity_bed == '' and type_room_id != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).order_by(asc(Room.price))\r\n        if quantity_bed != '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.quantity_bed == quantity_bed).order_by(asc(Room.price))\r\n        if type_room_id != '' and quantity_bed != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).filter(\r\n                Room.quantity_bed == quantity_bed).order_by(asc(Room.price))\r\n    if price_order_by == 'desc':\r\n        if quantity_bed == '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).order_by(desc(Room.price))\r\n        if quantity_bed == '' and type_room_id != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).order_by(desc(Room.price))\r\n        if quantity_bed != '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.quantity_bed == quantity_bed).order_by(desc(Room.price))\r\n        if type_room_id != '' and quantity_bed != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).filter(\r\n                Room.quantity_bed == quantity_bed).order_by(desc(Room.price))\r\n\r\n    return len(query.all())\r\n\r\n\r\ndef filters_room(type_room_id, quantity_bed, price_order_by, page):\r\n    page_size = app.config['PAGE_SIZE']\r\n    start = (page - 1) * page_size\r\n    end = start + page_size\r\n\r\n    query = \"\"\r\n    if (type_room_id == '' and quantity_bed == '' and price_order_by == '') or \\\r\n            (type_room_id is None and quantity_bed is None and price_order_by is None):\r\n        query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                 Room.descriptions, TypeRoom.type_room_name).filter(\r\n            Room.type_room_id == TypeRoom.id).order_by(asc(Room.price))\r\n    if price_order_by == 'asc':\r\n        if quantity_bed == '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).order_by(asc(Room.price))\r\n        if quantity_bed == '' and type_room_id != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).order_by(asc(Room.price))\r\n        if quantity_bed != '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.quantity_bed == quantity_bed).order_by(asc(Room.price))\r\n        if type_room_id != '' and quantity_bed != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).filter(\r\n                Room.quantity_bed == quantity_bed).order_by(asc(Room.price))\r\n    if price_order_by == 'desc':\r\n        if quantity_bed == '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).order_by(desc(Room.price))\r\n        if quantity_bed == '' and type_room_id != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).order_by(desc(Room.price))\r\n        if quantity_bed != '' and type_room_id == '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.quantity_bed == quantity_bed).order_by(desc(Room.price))\r\n        if type_room_id != '' and quantity_bed != '':\r\n            query = db.session.query(Room.id, Room.quantity_bed, Room.price, Room.status, Room.type_room_id, Room.image,\r\n                                     Room.descriptions, TypeRoom.type_room_name).filter(\r\n                Room.type_room_id == TypeRoom.id).filter(Room.type_room_id == type_room_id).filter(\r\n                Room.quantity_bed == quantity_bed).order_by(desc(Room.price))\r\n\r\n    return query.slice(start, end).all()\r\n\r\n\r\n# Add cart\r\ndef add_rental_voucher(booking_date):\r\n    rental_voucher = RentalVoucher(booking_date=booking_date)\r\n    db.session.add(rental_voucher)\r\n    db.session.commit()\r\n\r\n\r\n# Payment\r\ndef add_rental_voucher_detail(visit_name, type_visit_id, phone_number, rental_voucher_id, email, visit_name_id, nation):\r\n    rental_voucher_detail = RentalVoucherDetail(visit_name=visit_name,\r\n                                                type_visit_id=type_visit_id,\r\n                                                phone_number=phone_number,\r\n                                                rental_voucher_id=rental_voucher_id,\r\n                                                email=email,\r\n                                                visit_name_id=type_visit_id,\r\n                                                nation=nation)\r\n    db.session.add(rental_voucher_detail)\r\n    db.session.commit()\r\n\r\n\r\ndef get_new_record_rental_voucher_detai():\r\n    query = db.session.query(RentalVoucherDetail.id).order_by(RentalVoucherDetail.id.desc())\r\n    return query.first()\r\n\r\ndef get_info_payer(id):\r\n    query = db.session.query(RentalVoucherDetail.visit_name, RentalVoucherDetail.phone_number,\r\n                             RentalVoucherDetail.email,RentalVoucherDetail.nation).filter(RentalVoucherDetail.id == id)\r\n    return query.first()\r\n\r\ndef delete_all_receipt_detail():\r\n    query = db.session.query(ReceiptDetail).delete()\r\n    db.session.commit()\r\n\r\n\r\ndef add_booking_room(room_id,\r\n                     room_name,\r\n                     price,\r\n                     image,\r\n                     receive_day,\r\n                     pay_day,\r\n                     person_amount,\r\n                     rental_voucher_detail_id):\r\n    booking_room = BookingRoom(room_id=room_id,\r\n                               room_name=room_name,\r\n                               price=price,\r\n                               image=image,\r\n                               receive_day=receive_day,\r\n                               pay_day=pay_day,\r\n                               person_amount=person_amount,\r\n                               rental_voucher_detail_id=rental_voucher_detail_id)\r\n    db.session.add(booking_room)\r\n    db.session.commit()\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/utils.py b/src/utils.py
--- a/src/utils.py	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/utils.py	(date 1641635383289)
@@ -13,8 +13,8 @@
 mydb = mysql.connector.connect(
     host="localhost",
     user="root",
-    passwd="Duchieu200301",
-    database="hotel_management_db"
+    passwd="12345678",
+    database="hotel"
 )
 
 
@@ -310,3 +310,6 @@
                                rental_voucher_detail_id=rental_voucher_detail_id)
     db.session.add(booking_room)
     db.session.commit()
+
+def get_info_booking_room():
+    return BookingRoom.query.all()
\ No newline at end of file
Index: src/templates/cart.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends 'layout/base.html' %}\r\n\r\n{% block title %}Phòng của tôi{% endblock %}\r\n\r\n{% block content %}\r\n<h1 class=\"myCart\">PHÒNG CỦA TÔI</h1>\r\n\r\n{% if err:%}\r\n<h1 class=\"text-center alert alert-danger\">{{err}}</h1>\r\n{% endif %}\r\n{% if list_cart %}\r\n<h3 class=\"cart-h3\">Danh sách phòng đã đặt:</h3>\r\n<hr class=\"cart-hr\">\r\n<div class=\"container\">\r\n    <div class=\"row\">\r\n        <div class=\"col-lg-7\">\r\n            <div class=\"row list-cart\" id=\"list-room\">\r\n                <input type=\"text\" class=\"search-cart\" onkeyup=\"searchCart(this)\" placeholder=\"Nhập từ khóa...\"\r\n                       title=\"Tìm kiếm theo tên\">\r\n                {% for i in list_cart %}\r\n                <div class=\"row col-lg-12 lc  room-cart\">\r\n\r\n                    <div class=\"col-lg-3\">\r\n                        <img src=\"{{i.image}}\">\r\n                    </div>\r\n\r\n                    <div class=\"col-lg-6\">\r\n                        <div class=\"name-room\">\r\n                            <span id=\"name-cart\">{{i.room_name}}</span>\r\n                            <span class=\"person-amount\">{{i.person_amount}} người</span>\r\n                        </div>\r\n                        <div class=\"date-order\">\r\n                            <div>Ngày nhận: <span class=\"color-gray\">{{i.pay_day}}</span></div>\r\n                            <span>Ngày trả: <span class=\"color-gray\">{{i.receive_day}}</span></span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"col-lg-2 color-money\">\r\n                        {{i.price}}$\r\n                    </div>\r\n\r\n                    <div class=\"col-lg-1\">\r\n                        <input type=\"button\" name=\"{{i.id}}\" class=\"btn btn-del\" value=\"xóa\"\r\n                               onclick=\"deleteCart(this)\" data-bs-toggle=\"modal\"\r\n                               data-bs-target=\"#exampleModal\">\r\n                    </div>\r\n\r\n                </div>\r\n                {% endfor %}\r\n            </div>\r\n        </div>\r\n        <div class=\"col-lg-4\" id=\"pay\">\r\n            <h3>Thông tin đặt phòng</h3>\r\n            <div>Tổng tiền: <span id=\"total_money\">{{total_money}}$</span></div>\r\n            <div class=\"voucher\">\r\n                <input type=\"text\" placeholder=\"Nhập mã giảm giá\" name=\"\">\r\n                <input type=\"button\" value=\"Áp dụng\" class=\"btn btn-voucher\">\r\n            </div>\r\n            <a href=\"/payment\" class=\"btn btn-payment\"><span>Thanh toán</span></a>\r\n        </div>\r\n    </div>\r\n</div>\r\n{% else %}\r\n<div class=\"text-center\" style=\"margin-bottom: 17px\">Vui lòng đặt phòng!!!</div>\r\n<div class=\"text-center\">Cảm ơn bạn đã lựa chọn dịch vụ của Lotus Hotel !</div>\r\n{% endif %}\r\n<br><br><br><br>\r\n<!-- Modal -->\r\n<script>\r\n                            $(document).ready(function () {\r\n                                var is_open_modal = '{{ is_open_modal }}'\r\n                                console.log('is open modal', is_open_modal)\r\n                                if (is_open_modal === 'True'){\r\n                                    $('#exampleModal').modal('show');\r\n                                }\r\n                            });\r\n\r\n\r\n</script>\r\n<div class=\"modal fade\" id=\"exampleModal\" style=\"z-index: 90000000000\" tabindex=\"9\" aria-labelledby=\"exampleModalLabel\"\r\n     aria-hidden=\"true\" role=\"dialog\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"exampleModalLabel\">Trạng thái</h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div style=\"display: flex; align-items:center\">\r\n                    <div class=\"icon-payment-success\" style=\"width: 50px; height: 50px\">\r\n                        <img src=\"https://res.cloudinary.com/dwgjmgf6o/image/upload/v1641224187/icons/success-icon_bmd0a4.png\"\r\n                             alt=\"icon-payment\"\r\n                             style=\"width: 100%\"/>\r\n                    </div>\r\n                    <div style=\"display:flex; align-items:center; margin-left: 16px;\">\r\n                        <p style=\"margin: 8px auto;\">Xóa thành công !</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\"\r\n                        class=\"btn btn-secondary\"\r\n                        data-bs-dismiss=\"modal\"\r\n                >Đóng\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/templates/cart.html b/src/templates/cart.html
--- a/src/templates/cart.html	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/templates/cart.html	(date 1641633333122)
@@ -40,7 +40,7 @@
                     </div>
 
                     <div class="col-lg-1">
-                        <input type="button" name="{{i.id}}" class="btn btn-del" value="xóa"
+                        <input type="button" name="{{i[2]}}" class="btn btn-del" value="xóa"
                                onclick="deleteCart(this)" data-bs-toggle="modal"
                                data-bs-target="#exampleModal">
                     </div>
Index: src/index.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import hashlib\r\nimport hmac\r\nimport json\r\nimport math\r\nimport os\r\nimport re\r\nimport smtplib\r\nimport urllib\r\nimport uuid\r\nfrom datetime import datetime\r\n\r\nimport utils\r\nfrom urllib.request import urlopen, Request\r\nfrom flask import Flask, render_template, request, url_for, redirect, session, jsonify, make_response\r\nfrom flask_login import login_user, logout_user\r\nfrom src import app, login\r\nfrom src.admin import *\r\nimport requests\r\n\r\n\r\n@app.context_processor\r\ndef repos():\r\n    return {\r\n        \"cart\": len(utils.total_room_by_receiptId(0))\r\n    }\r\n\r\n\r\n@app.route('/', methods=['post', 'get'])\r\ndef home_page():\r\n    filter_room_list = []\r\n    type_room_id = \"\"\r\n    quantity_bed = \"\"\r\n    price_sort = \"\"\r\n\r\n    if request.method.__eq__('POST'):\r\n        type_room_id = request.form.get('type-room-id')\r\n        quantity_bed = request.form.get('quantity-bed')\r\n        price_sort = request.form.get('price-sort')\r\n\r\n    page = request.args.get('page', 1)\r\n    filter_room_list = utils.filters_room(type_room_id=type_room_id,\r\n                                          quantity_bed=quantity_bed,\r\n                                          price_order_by=price_sort,\r\n                                          page=int(page))\r\n\r\n    page_counter = utils.count_rooms(type_room_id=type_room_id,\r\n                                     quantity_bed=quantity_bed,\r\n                                     price_order_by=price_sort)\r\n\r\n    current_page = math.ceil(page_counter / app.config['PAGE_SIZE'])\r\n\r\n    return render_template('index.html',\r\n                           filter_room_list=filter_room_list,\r\n                           pages=current_page,\r\n                           type_room_id=type_room_id,\r\n                           price_sort=price_sort)\r\n\r\n\r\n@app.route('/about')\r\ndef about_us_page():\r\n    return render_template('about-us.html')\r\n\r\n\r\n\r\n@app.route('/register', methods=['post', 'get'])\r\ndef user_register():\r\n    err_msg = \"\"\r\n    if request.method.__eq__('POST'):\r\n        username = request.form.get('username')\r\n        password = request.form.get('password')\r\n        confirm = request.form.get('confirm')\r\n        email = request.form.get('email')\r\n        try:\r\n            if password.strip().__eq__(confirm.strip()):\r\n\r\n                utils.add_user(username=username,\r\n                               password=password, email=email)\r\n                return redirect(url_for('user_signin'))\r\n            else:\r\n                err_msg = \"Xác nhận mật khẩu không trùng khớp với Mật khẩu !!! \"\r\n        except Exception as ex:\r\n            err_msg = \"Có lỗi xảy ra rồi !! \" + str(ex)\r\n\r\n    return render_template('register.html', err_msg=err_msg)\r\n\r\n\r\n@app.route('/user-login', methods=['post', 'get'])\r\ndef user_signin():\r\n    err_msg = ''\r\n\r\n    if request.method.__eq__('POST'):\r\n        username = request.form.get('username')\r\n        password = request.form.get('password')\r\n\r\n        user = utils.check_login(username=username, password=password)\r\n        if user:\r\n            login_user(user=user)\r\n            return redirect(url_for('home_page'))\r\n        else:\r\n            err_msg = 'Username hay password không đúng, vui lòng kiểm tra lại'\r\n\r\n    return render_template('login.html', err_msg=err_msg)\r\n\r\n\r\n@app.route('/user-logout')\r\ndef user_signout():\r\n    logout_user()\r\n    return redirect(url_for('home_page'))\r\n\r\n\r\n@login.user_loader\r\ndef user_load(user_id):\r\n    return utils.get_user_by_id(user_id=user_id)\r\n\r\n\r\n\r\n@app.route('/contact-page')\r\ndef contact_page():\r\n    return render_template(\"contactPage.html\")\r\n\r\n\r\n\r\n@app.route('/my-room')\r\ndef cart():\r\n    err = \"\"\r\n    cart=[]\r\n    total_money=0\r\n    try:\r\n        cart = utils.get_list_receipt_detail()\r\n        total_money = utils.total_money(user_id=0)\r\n    except:\r\n        err = \"Trang web lỗi! Vui lòng thử lại sau\"\r\n    return render_template('cart.html', list_cart=cart, total_money=total_money, err=err)\r\n\r\n\r\n@app.route('/delete-cart', methods=['post'])\r\ndef delete_cart():\r\n    data = json.loads(request.data)\r\n    id = str(data.get(\"id\"))\r\n    tb = True\r\n    try:\r\n        utils.delete_Receipt_detail(id=id)\r\n    except:\r\n        tb =False\r\n\r\n    total_money = utils.total_money(user_id=0)\r\n\r\n    return jsonify(tb, len(utils.total_room_by_receiptId(0)), total_money)\r\n\r\n\r\n\r\n@app.route(\"/rooms/<int:room_id>\")\r\ndef room_detail_page(room_id):\r\n    room = utils.get_room_by_id(room_id)\r\n    type_room = utils.get_type_room_by_room_id(room_id)\r\n    return render_template('room-detail.html', room=room, type_room=type_room)\r\n\r\n\r\n@app.route('/api/cart', methods=['post'])\r\ndef add_to_cart():\r\n    if 'cart' not in session:\r\n        session['cart'] = {}\r\n\r\n    cart = session['cart']\r\n\r\n    data = json.loads(request.data)\r\n    id = str(data.get(\"id\"))\r\n    name = data.get(\"name\")\r\n    price = data.get(\"price\", 0)\r\n    quantity = 1\r\n\r\n    receive_day = data.get(\"receive-day\")\r\n    pay_day = data.get(\"pay-day\")\r\n    person_amount = str(data.get(\"person-amount\"))\r\n\r\n    cart = session.get('cart')\r\n\r\n    if id in cart:\r\n        cart[id]['quantity'] = cart[id]['quantity'] + 1\r\n    else:\r\n        cart[id] = {\r\n            \"id\": id,\r\n            \"name\": name,\r\n            \"price\": price,\r\n            \"quantity\": 1,\r\n        }\r\n\r\n    session['cart'] = cart\r\n\r\n    booking_infor = {\r\n        \"receive_day\": receive_day,\r\n        \"pay_day\": pay_day,\r\n        \"person_amount\": person_amount\r\n    }\r\n\r\n    utils.add_receipt_detail(room_id=int(id),\r\n                             room_name=name,\r\n                             price=float(price),\r\n                             quantity=float(quantity),\r\n                             receive_day=receive_day,\r\n                             pay_day=pay_day,\r\n                             person_amount=int(person_amount))\r\n    print('person_amount', person_amount)\r\n\r\n    return jsonify(utils.cart_stats(cart), cart, booking_infor, len(utils.total_room_by_receiptId(0)))\r\n\r\n\r\n@app.route('/payment', methods=['post', 'get'])\r\ndef payment_page():\r\n    list_booking_room = utils.get_list_receipt_detail()\r\n    total_price = utils.total_money(user_id=0)\r\n\r\n    # Default variable\r\n    fullname = \"default\"\r\n    email = \"default\"\r\n    nation = \"default\"\r\n    identify = \"default\"\r\n    phone_number = \"default\"\r\n    offline_payment = \"\"\r\n    online_payment = \"\"\r\n    is_sendmail_success = False\r\n\r\n    # Validate variable\r\n    fullname_validate = \"\"\r\n    email_validate = \"\"\r\n    nation_validate = \"\"\r\n    identify_validate = \"\"\r\n    phone_number_validate = \"\"\r\n\r\n    # Open success modal\r\n    is_open_modal = False\r\n\r\n    if request.method.__eq__('POST'):\r\n        fullname = request.form.get('payment-fullname')\r\n        email = request.form.get('payment-email')\r\n        nation = request.form.get('payment-nation')\r\n        identify = request.form.get('payment-identify')\r\n        phone_number = request.form.get('payment-phone-number')\r\n        offline_payment = request.form.get('offline-payment')\r\n        online_payment = request.form.get('online-payment')\r\n\r\n    # print('online', online_payment)\r\n    # print('ofline', offline_payment)\r\n\r\n    # Validate fullname (thêm dâu cách và Tiếng việt thì check sai)\r\n    if fullname == \"\":\r\n        fullname_validate = \"Hãy nhập họ và tên!\"\r\n    else:\r\n        if re.match(r'[a-zA-Z\\s]+$', fullname) is None:\r\n            fullname_validate = \"Họ tên không hợp lệ!\"\r\n\r\n    # Validate email\r\n    if email == \"\":\r\n        email_validate = \"Hãy nhập email!\"\r\n    else:\r\n        if re.match(r'\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b', email) is None and email != \"default\":\r\n            email_validate = \"Email không hợp lệ!\"\r\n\r\n    # Validate nation (thêm dâu cách và Tiếng việt thì check sai)\r\n    if nation == \"\":\r\n        nation_validate = \"Hãy nhập tên quốc gia/khu vực!\"\r\n    else:\r\n        if re.match(r'[a-zA-Z\\s]+$', nation) is None:\r\n            nation_validate = \"Tên quốc gia/khu vực không hợp lệ!\"\r\n\r\n    # Validate identify\r\n    if identify == \"\":\r\n        identify_validate = \"Hãy nhập số CMND/Passport!\"\r\n    else:\r\n        if re.match('^[0-9]+$', identify) is None and email != \"default\":\r\n            identify_validate = \"Số CMND/Passport không hợp lệ!\"\r\n\r\n    # Validate phone number (not work)\r\n    if phone_number == \"\":\r\n        phone_number_validate = \"Hãy nhập số điện thoại!\"\r\n    else:\r\n        if re.match(r\"[\\d]{3}[\\d]{3}[\\d]{3}\", phone_number) is None and email != \"default\":\r\n            phone_number_validate = \"Số điện thoại không hợp lệ!\"\r\n\r\n    # Check data before add to database\r\n    if fullname != \"default\" and fullname != \"\" and fullname_validate == \"\" and \\\r\n            email != \"default\" and email != \"\" and email_validate == \"\" and \\\r\n            nation != \"default\" and nation != \"\" and nation_validate == \"\" and \\\r\n            identify != \"default\" and identify != \"\" and identify_validate == \"\" and \\\r\n            phone_number != \"default\" and phone_number != \"\" and phone_number_validate == \"\":\r\n        utils.add_rental_voucher_detail(visit_name=fullname,\r\n                                        type_visit_id=1,\r\n                                        phone_number=phone_number,\r\n                                        rental_voucher_id=1,\r\n                                        email=email,\r\n                                        visit_name_id=1,\r\n                                        nation=nation)\r\n        utils.add_rental_voucher(booking_date=datetime.now())\r\n\r\n        rental_voucher_detail_id = utils.get_new_record_rental_voucher_detai()[0]\r\n        print('check rental voucher id', rental_voucher_detail_id)\r\n        message = 'XÁC NHẬN ĐẶT PHÒNG THÀNH CÔNG\\n\\nChúng tôi xin trân trọng gửi đến quý khách thư xác nhận rằng quý khách đã thực hiện thao tác đặt phòng thành công.\\nCảm ơn quý khách đã sử dụng dich vụ của Lotus Hotel.\\nMã đặt phòng của quý khách là: ' + str(rental_voucher_detail_id) + ' \\nĐể nhận phòng, quý khách vui lòng trình diện mã đặt phòng cho lễ tân tại sảnh chính khách sạn.\\nXin trân trọng cảm ơn.\\n\\n\\nLIÊN HỆ\\nEmail: hotel.lotus371@gmail.com\\nTổng đài: 1-548-854-8898\\nĐịa chỉ: 371 Nguyễn Kiệm, quận Gò Vấp, TP. Hồ Chí Minh'\r\n\r\n        server = smtplib.SMTP(\"smtp.gmail.com\", 587)\r\n        server.starttls()\r\n        server.login(\"hotel.lotus371@gmail.com\", \"!Hotellotus371\")\r\n        server.sendmail(\"hotel.lotus371@gmail.com\", email, message.encode('utf-8'))\r\n        server.quit()\r\n        try:\r\n            print('check mail sending', server.sendmail(\"hotel.lotus371@gmail.com\", email, message.encode('utf-8')))\r\n        except (IOError, OSError):\r\n            print(\"Handling OSError...\")\r\n        is_sendmail_success = True\r\n\r\n        # Check modal will be open\r\n        if fullname != \"default\" and fullname_validate == \"\" and \\\r\n                email != \"default\" and email_validate == \"\" and \\\r\n                nation != \"default\" and nation_validate == \"\" and \\\r\n                identify != \"default\" and identify_validate == \"\" and \\\r\n                phone_number != \"default\" and phone_number_validate == \"\" and \\\r\n                is_sendmail_success is True:\r\n            is_open_modal = True\r\n\r\n    return render_template('payment.html',\r\n                           list_booking_room=list_booking_room,\r\n                           total_price=total_price,\r\n                           fullname_validate=fullname_validate,\r\n                           email_validate=email_validate,\r\n                           nation_validate=nation_validate,\r\n                           identify_validate=identify_validate,\r\n                           phone_number_validate=phone_number_validate,\r\n                           is_open_modal=is_open_modal,\r\n                           is_sendmail_success=is_sendmail_success)\r\n\r\n\r\n@app.route('/payment/success')\r\ndef payment_success_page():\r\n    booking_room_backup = utils.get_list_receipt_detail()\r\n    booking_room_backup_converter = []\r\n\r\n    for row in booking_room_backup[0]:\r\n        booking_room_backup_converter.append(row)\r\n    print('booking_room_array ', booking_room_backup_converter)\r\n\r\n    booking_room_id = booking_room_backup_converter[8]\r\n    booking_room_name = booking_room_backup_converter[1]\r\n    booking_room_image = booking_room_backup_converter[0]\r\n    booking_room_receive_day = booking_room_backup_converter[6]\r\n    booking_room_pay_day = booking_room_backup_converter[3]\r\n    booking_room_price = booking_room_backup_converter[4]\r\n    booking_room_person_amount = booking_room_backup_converter[7]\r\n\r\n    # Backup data receipt detail to booking room before delete receipt detail\r\n    utils.add_booking_room(room_id=booking_room_id,\r\n                           room_name=booking_room_name,\r\n                           price=booking_room_price,\r\n                           image=booking_room_image,\r\n                           receive_day=booking_room_receive_day,\r\n                           pay_day=booking_room_pay_day,\r\n                           person_amount=booking_room_person_amount,\r\n                           rental_voucher_detail_id=1)\r\n\r\n    # Delete all receipt detail when payment success\r\n    utils.delete_all_receipt_detail()\r\n    return render_template(\"payment-success.html\")\r\n\r\n\r\n<<<<<<< HEAD\r\n@app.route('/history')\r\ndef history():\r\n    id_new = utils.get_new_record_rental_voucher_detai()\r\n\r\n    info_payer = utils.get_info_payer(id_new.id)\r\n\r\n    return render_template(\"history-payments.html\", info_payer=info_payer)\r\n=======\r\n@app.route('/gallery')\r\ndef gallery_image_page():\r\n    return render_template('gallery.html')\r\n\r\n>>>>>>> develop\r\n\r\nif __name__ == \"__main__\":\r\n    from src.admin import *\r\n\r\n    app.run(debug=True)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/index.py b/src/index.py
--- a/src/index.py	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/index.py	(date 1641635383255)
@@ -360,20 +360,21 @@
     return render_template("payment-success.html")
 
 
-<<<<<<< HEAD
+
 @app.route('/history')
 def history():
     id_new = utils.get_new_record_rental_voucher_detai()
 
     info_payer = utils.get_info_payer(id_new.id)
 
-    return render_template("history-payments.html", info_payer=info_payer)
-=======
+    list_booking_room = utils.get_info_booking_room()
+    return render_template("history-payments.html", info_payer=info_payer, list_booking_room=list_booking_room)
+
 @app.route('/gallery')
 def gallery_image_page():
     return render_template('gallery.html')
 
->>>>>>> develop
+
 
 if __name__ == "__main__":
     from src.admin import *
Index: src/static/js/cart.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>const addToCart = (id, name, price, receiveDay, payDay, personAmount) => {\r\n    event.preventDefault();\r\n\r\n    fetch('/api/cart', {\r\n        method: 'post',\r\n        body: JSON.stringify({\r\n            \"id\": id,\r\n            \"name\": name,\r\n            \"price\": price,\r\n            \"receive-day\": receiveDay,\r\n            \"pay-day\": payDay,\r\n            \"person-amount\": personAmount,\r\n        }),\r\n        headers: {\r\n            'Context-Type': 'application/json'\r\n        }\r\n    }).then(\r\n    res => {\r\n        if (res) {\r\n            if (res?.status !== 500) {\r\n                console.log(\"Thao tác thành công\")\r\n                console.log(\"res\", res)\r\n                return res.json()\r\n            }\r\n            else {\r\n                console.log(\"Thao tác thất bại\", res?.statusText)\r\n            }\r\n        }\r\n    }\r\n    ).then(data => {\r\n            console.log('data', data);\r\n            total_quantity = document.getElementById(\"countCart\");\r\n            total_quantity.innerHTML = data[3];\r\n            //Show toast message\r\n            handleShowToast();\r\n        }\r\n    ).catch(err => {\r\n            console.log(err);\r\n        }\r\n    );\r\n}\r\n\r\nconst handleShowToast = () => {\r\n    var toastEl = document.getElementById(\"toast-message\");\r\n    toastEl.className = \"show\";\r\n    setTimeout(() => { toastEl.className = toastEl.className.replace(\"show\", \"\"); }, 3000);\r\n}\r\n\r\nfunction searchCart(element){\r\n    text = element.value.toUpperCase();\r\n    l = document.getElementById(\"list-room\");\r\n    listRoom = l.getElementsByClassName(\"room-cart\")\r\n//    listName = listRoom.getElementsByClassName(\"name-cart\")\r\n    for (i= 0; i < listRoom.length; i++){\r\n        nameRoom = listRoom[i].getElementsByTagName(\"span\")[0].innerHTML;\r\n        if(nameRoom.toUpperCase().indexOf(text) > -1){\r\n            listRoom[i].style.display = \"\";\r\n        } else{\r\n            listRoom[i].style.display = \"none\";\r\n        }\r\n    }\r\n}\r\nfunction confirmDelete(element){\r\n//    var result = confirm(\"Bạn có muốn xóa phòng này?\");\r\n//        if (result == true) {\r\n//            deleteCart(element);\r\n//        }\r\n    swal({\r\n      title: \"Bạn có chắc chắn muốn xóa phòng này?\",\r\n      icon: \"warning\",\r\n      buttons: true,\r\n      dangerMode: true,\r\n    })\r\n    .then((willDelete) => {\r\n      if (willDelete) {\r\n        deleteCart(element);\r\n\r\n      } else {\r\n        swal(\"Hủy xóa !!!\");\r\n      }\r\n    });\r\n}\r\n\r\nfunction deleteCart(element){\r\n//    event.preventDefault();\r\n    fetch('/delete-cart', {\r\n        method: 'post',\r\n        body: JSON.stringify({\r\n            \"id\": element.name\r\n        }),\r\n        headers: {\r\n            'Context-Type': 'application/json'\r\n        }\r\n    }).then(\r\n    res => {\r\n        if (res) {\r\n            if (res?.status !== 500) {\r\n                console.log(\"Thao tác thành công\")\r\n                return res.json()\r\n            }\r\n            else {\r\n                console.log(\"Thao tác thất bại\", res?.statusText)\r\n            }\r\n        }\r\n    }\r\n    ).then(data => {\r\n//            if (data[0] == true){\r\n//                swal(\"Đã xóa thành công!!!\", {\r\n//                  icon: \"success\",\r\n//                });\r\n//            }\r\n//            else{\r\n//                 swal(\"Hệ thống đang bảo trì! Vui lòng quay lại sau!\", {\r\n//                  icon: \"error\",\r\n//                });\r\n//            }\r\n//            alert(data[0]);\r\n            total_quantity = document.getElementById(\"countCart\");\r\n            total_quantity.innerHTML = data[1];\r\n\r\n            total_money = document.getElementById(\"total_money\");\r\n            total_money.innerHTML = (data[2].toFixed(1)) + \"$\";\r\n            hideRoomDeleted(element);\r\n        }\r\n    ).catch(err => {\r\n            console.log(err);\r\n        }\r\n    );\r\n}\r\n\r\n\r\nfunction hideRoomDeleted(element){\r\n    roomIdDelete = element.name;\r\n    l = document.getElementById(\"list-room\");\r\n    listRoom = l.getElementsByClassName(\"room-cart\")\r\n//    listName = listRoom.getElementsByClassName(\"name-cart\")\r\n    for (i= 0; i < listRoom.length; i++){\r\n        roomId = listRoom[i].getElementsByTagName(\"input\")[0].name;\r\n        if(roomIdDelete == roomId ){\r\n            listRoom[i].style.display = \"none\";\r\n        }\r\n    }\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/static/js/cart.js b/src/static/js/cart.js
--- a/src/static/js/cart.js	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/static/js/cart.js	(date 1641631468695)
@@ -82,7 +82,7 @@
 }
 
 function deleteCart(element){
-//    event.preventDefault();
+    event.preventDefault();
     fetch('/delete-cart', {
         method: 'post',
         body: JSON.stringify({
Index: src/__init__.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from flask import Flask\r\nfrom flask_sqlalchemy import SQLAlchemy\r\nfrom flask_babelex import Babel\r\nfrom flask_login import LoginManager\r\nimport cloudinary\r\nfrom flask_migrate import Migrate\r\n\r\napp = Flask(__name__)\r\napp.secret_key = 'sfsjfffehr4$#$@$@$%^^^$^%@$GG'\r\n\r\n\r\napp.config[\"SQLALCHEMY_DATABASE_URI\"] = \"mysql+pymysql://root:Duchieu200301@localhost/hotel_management_db?charset=utf8mb4\"\r\n\r\napp.config[\"SQLALCHEMY_TRACK_MODIFICATIONS\"] = True\r\napp.config[\"PAGE_SIZE\"] = 6\r\n\r\ndb = SQLAlchemy(app=app)\r\nmigrate = Migrate(app, db)\r\nbabel = Babel(app=app)\r\n@babel.localeselector\r\ndef get_locale():\r\n        # Put your logic here. Application can store locale in\r\n        # user profile, cookie, session, etc.\r\n        return 'vi'\r\n\r\n\r\ncloudinary.config(cloud_name='dwgjmgf6o', api_key='963493837729524', api_secret='ra068pqFPrbpRrMDgE-Lua2hDZ8')\r\n\r\nlogin = LoginManager(app=app)
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/__init__.py b/src/__init__.py
--- a/src/__init__.py	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/__init__.py	(date 1641630888036)
@@ -9,7 +9,7 @@
 app.secret_key = 'sfsjfffehr4$#$@$@$%^^^$^%@$GG'
 
 
-app.config["SQLALCHEMY_DATABASE_URI"] = "mysql+pymysql://root:Duchieu200301@localhost/hotel_management_db?charset=utf8mb4"
+app.config["SQLALCHEMY_DATABASE_URI"] = "mysql+pymysql://root:12345678@localhost/hotel?charset=utf8mb4"
 
 app.config["SQLALCHEMY_TRACK_MODIFICATIONS"] = True
 app.config["PAGE_SIZE"] = 6
Index: src/templates/layout/header.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><header class=\"header\" id=\"header-fixed\">\r\n  <!-- Header-Top -->\r\n  <nav class=\"navbar navbar-expand-sm\" id=\"header-top\">\r\n    <!-- Links -->\r\n    <ul class=\"navbar-nav top-nav-right\">\r\n      <li class=\"nav-item\">\r\n<!--        <span>371 Nguyen Kiem, Go Vap district</span  >-->\r\n      </li>\r\n    </ul>\r\n\r\n    <ul class=\"navbar-nav top-nav-left\">\r\n      {% if current_user.is_authenticated %}\r\n      <li class=\"nav-item \">\r\n        <a class=\"nav-link\" href=\"{{ url_for('home_page') }}\">\r\n          {{ current_user.username }}\r\n        </a>\r\n      </li>\r\n      <li class=\"nav-item \">\r\n        <a class=\"nav-link\" href=\"{{ url_for('user_signout') }}\">Đăng xuất</a>\r\n      </li>\r\n      {% else %}\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('user_signin') }}\">Đăng nhập</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('user_register') }}\">Đăng ký</a>\r\n      </li>\r\n      {% endif %}\r\n    </ul>\r\n  </nav>\r\n\r\n  <!-- Header-Nav -->\r\n  <nav class=\"navbar navbar-expand-sm\" >\r\n    <!-- Brand -->\r\n    <a class=\"navbar-brand\" href=\"/\">\r\n      <img src=\"{{ url_for('static', filename='images/logo-header.png')}}\" alt=\"Logo\">\r\n    </a>\r\n\r\n    <!-- Links -->\r\n    <ul class=\"navbar-nav bottom-nav\">\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\">Nhà hàng & Quầy bar</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\">Trải nghiệm</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('gallery_image_page')}}\">Thư viện ảnh</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\"> | </a>\r\n      </li>\r\n      {% if current_user.is_authenticated and current_user.user_role.value == 1 %}\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"/admin\"> Quản trị </a>\r\n      </li>\r\n      {% endif %}\r\n      {% if current_user.is_authenticated and current_user.user_role.value == 2 %}\r\n      <li class=\"nav-item\">\r\n<<<<<<< HEAD\r\n        <a class=\"nav-link disabled\" href=\"#\"> | </a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('cart')}} \"> Phòng của tôi <span class=\"badge badge-info\" style=\"padding-bottom: 1px; padding-top: 2px; font-size: 13px;\" id=\"countCart\">{{ cart}}</span></a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link disabled\" href=\"#\"> | </a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('history') }}\">Lịch sử</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('contact_page') }}\">Liên hệ</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"#\">Về chúng tôi</a>\r\n=======\r\n        <a class=\"nav-link\" href=\"{{ url_for('cart')}} \"> Phòng của tôi <span class=\"badge badge-info\"\r\n                                                                              style=\"padding-bottom: 1px; padding-top: 2px; font-size: 13px;\"\r\n                                                                              id=\"countCart\">{{ cart}}</span></a>\r\n>>>>>>> develop\r\n      </li>\r\n      {% endif %}\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('contact_page') }}\">Liên hệ</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" href=\"{{ url_for('about_us_page') }}\">Về chúng tôi</a>\r\n      </li>\r\n      <li class=\"nav-item dropdown\">\r\n        <a class=\"nav-link dropdown-toggle\"\r\n           href=\"#\"\r\n           id=\"navbardrop\"\r\n           data-toggle=\"dropdown\">\r\n          <span class=\"material-icons\">\r\n            public\r\n          </span>\r\n        </a>\r\n        <div class=\"dropdown-menu\">\r\n          <a class=\"dropdown-item\" href=\"#\">\r\n            <div>\r\n              <img src=\"https://res.cloudinary.com/dwgjmgf6o/image/upload/v1641626611/icons/vietnam-flag-icon_lbnujo.png\"\r\n                   alt=\"vietnam-flag-icon\"/>\r\n            </div>\r\n          </a>\r\n          <a class=\"dropdown-item\" href=\"#\">\r\n            <div>\r\n              <img src=\"https://res.cloudinary.com/dwgjmgf6o/image/upload/v1641626611/icons/united-states-flag-icon_yshv3m.png\"\r\n                   alt=\"usa-flag-icon\"/>\r\n            </div>\r\n          </a>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </nav>\r\n\r\n    <!--  Scroll -->\r\n  <div class=\"progress-container\" id=\"scrollIndicator\">\r\n    <div class=\"progress-bar\" id=\"myBar\"></div>\r\n  </div>\r\n\r\n</header>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/templates/layout/header.html b/src/templates/layout/header.html
--- a/src/templates/layout/header.html	(revision 0b643c49d8065d5a44904a4ac22cb964d659a544)
+++ b/src/templates/layout/header.html	(date 1641633473257)
@@ -56,10 +56,7 @@
       </li>
       {% endif %}
       {% if current_user.is_authenticated and current_user.user_role.value == 2 %}
-      <li class="nav-item">
-<<<<<<< HEAD
-        <a class="nav-link disabled" href="#"> | </a>
-      </li>
+
       <li class="nav-item">
         <a class="nav-link" href="{{ url_for('cart')}} "> Phòng của tôi <span class="badge badge-info" style="padding-bottom: 1px; padding-top: 2px; font-size: 13px;" id="countCart">{{ cart}}</span></a>
       </li>
@@ -68,17 +65,6 @@
       </li>
       <li class="nav-item">
         <a class="nav-link" href="{{ url_for('history') }}">Lịch sử</a>
-      </li>
-      <li class="nav-item">
-        <a class="nav-link" href="{{ url_for('contact_page') }}">Liên hệ</a>
-      </li>
-      <li class="nav-item">
-        <a class="nav-link" href="#">Về chúng tôi</a>
-=======
-        <a class="nav-link" href="{{ url_for('cart')}} "> Phòng của tôi <span class="badge badge-info"
-                                                                              style="padding-bottom: 1px; padding-top: 2px; font-size: 13px;"
-                                                                              id="countCart">{{ cart}}</span></a>
->>>>>>> develop
       </li>
       {% endif %}
       <li class="nav-item">
